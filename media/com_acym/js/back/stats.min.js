jQuery(document).on("acy_preview_loaded",()=>{let t=jQuery("#acym__stats_click__map__all-links__click");if(t.length<1)return;let _=JSON.parse(t.val());jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body").prepend(jQuery("#acym__stats__add_style_export__click-map").html()),jQuery.each(_,(t,a)=>{if("allClick"===t)return;jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find('[href="'+t+'"]').css({position:"relative",overflow:"initial",display:"inline-block"}).append('<span class="acym__stats__cliked__link__percentage overviewbubble" style="background-color: rgba('+a.color+', 0.8);"><span class="acym__tooltip" style="display:flex;justify-content:center;align-items:center;"><span class="acym__tooltip__text"> <span class="acym__tooltip__title">'+acym_helper.sprintf(ACYM_JS_TXT.ACYM_OF_CLICKS,'<span class="acym__color__light-blue">'+a.percentage+"%</span> ")+"</span>"+acym_helper.sprintf(ACYM_JS_TXT.ACYM_CLICKS_OUT_OF,"<b>"+a.numberClick+"</b>"," <b> "+_.allClick+"</b>")+"</span>"+a.percentage+"%</span></span>")}),acym_helperTooltip.setTooltip()}),jQuery(document).ready(function(t){function _(){t(".acym__stats__export__button").on("click",function(){setTimeout(function(){t("#formSubmit")[0].disabled=!1,t('[name="task"]').val("")},5)})}function a(){t(".acym__stats__export__global__charts").off("click").on("click",function(){let _=t(this),a=t("#acym__stats__export__global__charts__scope");_.attr("disabled","true"),e(a,_,"export_stats_global_")}),t(".acym__stats__export__click-map__charts").on("click",function(){let _=t(this),a=t("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body");_.attr("disabled","true"),e(a,_,"export_stats_click_map_")})}function e(_,a,e){html2canvas(_[0],{height:_.height()+100,width:_.width()+100,scrollY:-window.scrollY}).then(_=>{let c=_.toDataURL("image/png"),l=document.createElement("a"),n=new Date;l.download=e+""+n.getFullYear()+"_"+n.getMonth()+"_"+n.getDay()+".jpeg",l.href=c,l.click(),a.removeAttr("disabled"),t('[name="task"]').val("")})}t("#mail_id").off("change").on("change",function(){t(".acym__stats__select__language option:selected").val(0),t("#formSubmit").click()}),function(){let _=t("#chart__line__start"),a=t("#chart__line__end"),e=_.attr("data-start"),c=a.attr("data-end");_.val(e),a.val(c),t(".acym__stats__chart__line__input__date").off("change").on("change",function(){let e=moment(_.val(),"YYYY-MM-DD HH:mm").unix(),c=moment(a.val(),"YYYY-MM-DD HH:mm").add(1,"hours").unix();!function(_,a){let e=ACYM_AJAX_URL+'&ctrl=stats&task=setDataForChartLine"&start='+_+"&end="+a+"&id="+t("#mail_id").val();t.post(e,function(_){"error"==_?acym_helperNotification.addNotification(ACYM_JS_TXT.ACYM_STATS_START_DATE_LOWER,"warning"):t("#acym__stats__chart__line__canvas").html(_)})}(e,c)})}(),t(".select2-container--sortBy").css({width:"auto","min-width":"140px"}),_(),t('[name="export_type"]').select2({theme:"sortBy",minimumResultsForSearch:1/0}).on("change",function(){let e=t('[data-task="exportGlobal"]');e.off("click"),"charts"===t(this).val()?(e.removeClass("acy_button_submit").addClass("acym__stats__export__global__charts"),a()):(e.addClass("acy_button_submit").removeClass("acym__stats__export__global__charts"),acym_helper.setSubmitButtonGlobal()),_()}),a(),t(".acym__stats__select__language").off("change").on("change",function(){t("#formSubmit").click()}),acym_helperStats.setLineChartOpenTimeWeek()});